<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Details - GoatMouth</title>
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <script>
        window.ODDS_API_URL = 'https://goatmouth-odds-api.onrender.com';
    </script>

    <!-- Tailwind CSS (compiled) -->
    <link rel="stylesheet" href="css/output.css?v=4.6">

    <!-- Remix Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css?v=4.6">
    <link rel="stylesheet" href="css/mobile.css?v=4.6">
    <style>
        @media (max-width: 768px) {
            main {
                padding-top: 16px !important;
            }
        }
    </style>

    <!-- TradingView Lightweight Charts -->
    <script defer src="https://unpkg.com/lightweight-charts@4.1.3/dist/lightweight-charts.standalone.production.js"></script>

    <!-- Supabase -->
    <script defer src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script defer src="js/sanitize-helper.js?v=4.6"></script>

    <style>
        /* Market Page - Clean Dark Green Theme */
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        body {
            background: #0a0e0d;
        }

        .market-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
            overflow-x: hidden;
        }

        .market-grid {
            display: grid;
            grid-template-columns: 1fr 340px;
            gap: 1.5rem;
            margin-top: 1rem;
            overflow: visible;
        }

        @media (max-width: 1024px) {
            .market-grid {
                grid-template-columns: 1fr;
            }
            .market-sidebar {
                order: 1;
            }
            .market-main {
                order: 2;
            }
        }


        /* Hero Section - Compact */
        .market-hero {
            background: linear-gradient(135deg, rgba(2, 122, 64, 0.08) 0%, rgba(0, 0, 0, 0.4) 100%);
            border-radius: 0.75rem;
            padding: 1.25rem 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(0, 203, 151, 0.15);
            overflow: hidden;
        }

        .market-hero-content {
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.35) 0%, rgba(0, 0, 0, 0.1) 100%);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            backdrop-filter: blur(6px);
        }

        .market-hero-tint {
            background: linear-gradient(180deg, rgba(0, 140, 70, 0.22) 0%, rgba(0, 90, 50, 0.35) 100%);
            mix-blend-mode: multiply;
            pointer-events: none;
        }

        .chart-price-label {
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }

        #market-description {
            white-space: pre-wrap;
            max-height: none;
            overflow: visible;
        }

        #market-description-toggle {
            margin: 0.1rem auto 0.4rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.35rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: #ffffff;
            opacity: 0.9;
            transition: opacity 0.2s ease, transform 0.2s ease;
        }

        #market-description-toggle:hover {
            opacity: 1;
        }

        #market-description-toggle .chevron {
            font-size: 0.9rem;
            line-height: 1;
            transform: translateY(1px);
            transition: transform 0.2s ease;
        }

        #market-description p:last-child,
        #about-description p:last-child {
            margin-bottom: 0;
        }

        .market-hero-stats {
            margin-top: 0.5rem;
        }

        .odds-card {
            position: relative;
            overflow: hidden;
            background: linear-gradient(180deg, rgba(10, 15, 26, 0.65) 0%, rgba(10, 15, 26, 0.8) 100%);
            border: 1px solid rgba(148, 163, 184, 0.08);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.25);
        }

        .odds-card-yes {
            background: linear-gradient(180deg, rgba(2, 122, 64, 0.28) 0%, rgba(2, 122, 64, 0.16) 100%);
        }

        .odds-card-no {
            background: linear-gradient(180deg, rgba(127, 29, 29, 0.28) 0%, rgba(127, 29, 29, 0.16) 100%);
        }

        .odds-card::before {
            content: '';
            position: absolute;
            inset: -40% 0 0 0;
            opacity: 0.28;
            pointer-events: none;
        }

        .odds-card-yes::before {
            background: radial-gradient(circle at 20% 10%, rgba(16, 185, 129, 0.35) 0%, rgba(16, 185, 129, 0.05) 60%, transparent 70%);
        }

        .odds-card-no::before {
            background: radial-gradient(circle at 20% 10%, rgba(239, 68, 68, 0.35) 0%, rgba(239, 68, 68, 0.05) 60%, transparent 70%);
        }

        .odds-card > * {
            position: relative;
            z-index: 1;
        }

        .stat-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.375rem 0.75rem;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 0.375rem;
            font-size: 0.75rem;
            border: 1px solid rgba(0, 203, 151, 0.12);
            font-weight: 500;
            overflow: hidden;
        }

        .stat-badge i {
            font-size: 0.875rem;
        }

        /* Cards */
        .chart-container, .section-card {
            background: rgba(15, 23, 20, 0.6);
            border-radius: 0;
            padding: 1.25rem;
            margin-bottom: 0;
            border: 1px solid rgba(0, 203, 151, 0.1);
            border-bottom: none;
            overflow: hidden;
        }

        .section-card:last-child {
            border-bottom: 1px solid rgba(0, 203, 151, 0.1);
            border-radius: 0 0 0.75rem 0.75rem;
        }

        .chart-container:first-child, .section-card:first-child {
            border-radius: 0.75rem 0.75rem 0 0;
        }

        .sidebar-card {
            background: rgba(15, 23, 20, 0.7);
            border-radius: 0;
            overflow: visible;
            padding: 1.25rem;
            margin-bottom: 0;
            border: 1px solid rgba(0, 203, 151, 0.12);
            border-bottom: none;
        }

        .sidebar-card:last-child {
            border-bottom: 1px solid rgba(0, 203, 151, 0.12);
            border-radius: 0 0 0.75rem 0.75rem;
        }

        .sidebar-card:first-child {
            border-radius: 0.75rem 0.75rem 0 0;
        }

        .market-sidebar {
            height: auto;
            min-height: auto;
            overflow: visible;
        }

        .market-main {
            display: flex;
            flex-direction: column;
        }

        /* Price Indicator */
        .price-indicator {
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1;
            letter-spacing: -0.02em;
            overflow: hidden;
        }

        /* Timeframe Selector */
        .timeframe-selector {
            display: flex;
            gap: 0.25rem;
            background: rgba(0, 0, 0, 0.4);
            padding: 0.25rem;
            border-radius: 0.5rem;
            border: 1px solid rgba(0, 203, 151, 0.1);
            overflow: hidden;
            flex-wrap: nowrap;
        }

        .timeframe-btn {
            padding: 0.375rem 0.875rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.15s;
            border: none;
            background: transparent;
            color: #6b7280;
            cursor: pointer;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .timeframe-btn.active {
            background: #027A40;
            color: #fff;
        }

        .timeframe-btn:hover:not(.active) {
            background: rgba(0, 203, 151, 0.1);
            color: #00CB97;
        }

        /* Activity Item */
        .activity-item {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 1rem;
            padding: 1rem;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0.2) 100%);
            border-radius: 0.75rem;
            margin-bottom: 0.75rem;
            border: 1px solid rgba(0, 203, 151, 0.1);
            transition: all 0.2s ease;
        }

        .activity-item:hover {
            background: linear-gradient(135deg, rgba(0, 203, 151, 0.05) 0%, rgba(0, 0, 0, 0.3) 100%);
            border-color: rgba(0, 203, 151, 0.2);
            transform: translateX(2px);
        }

        .activity-item:last-child {
            margin-bottom: 0;
        }

        /* Hide scrollbar for activity feed */
        #activity-feed::-webkit-scrollbar {
            display: none;
        }

        #activity-feed {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Position Card */
        .position-card {
            background: linear-gradient(135deg, rgba(2, 122, 64, 0.15) 0%, rgba(2, 122, 64, 0.08) 100%);
            border: 1px solid rgba(0, 203, 151, 0.25);
            border-radius: 0.625rem;
            padding: 0.875rem;
            margin-bottom: 0.875rem;
        }

        /* Bet Tabs */
        .bet-tab {
            flex: 1;
            padding: 0.625rem;
            border: none;
            background: transparent;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
            border-bottom: 2px solid transparent;
            font-size: 0.875rem;
        }

        .bet-tab.active {
            color: #00CB97;
            border-bottom-color: #027A40;
        }

        /* Section Headers */
        h3 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.875rem;
            color: #f3f4f6;
            letter-spacing: -0.01em;
        }

        /* Chart Styling */
        #priceChart {
            filter: drop-shadow(0 0 20px rgba(0, 203, 151, 0.05));
        }

        /* Hide Chart Table Scrollbars */
        .chart-container table,
        .chart-container table td,
        .chart-container table div {
            overflow: hidden !important;
        }

        .chart-container canvas {
            max-width: 100%;
        }

        /* Copy Button */
        .copy-btn {
            background: transparent;
            border: none;
            color: #6b7280;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 0.25rem;
            transition: all 0.2s;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .copy-btn:hover {
            color: #00CB97;
            background: rgba(0, 203, 151, 0.1);
        }

        .copy-btn.copied {
            color: #00CB97;
        }

        .copy-btn.copied i::before {
            content: "\eb7b";
        }

        @media (max-width: 768px) {
            /* Global Overflow Prevention */
            body, html {
                overflow-x: hidden;
            }

            /* Main Content Padding */
            main {
                margin-top: 0 !important;
                padding-top: 0 !important;
            }


            /* Container Spacing */
            .market-container {
                padding: 0 0.75rem;
                overflow-x: hidden;
            }

            .market-grid {
                gap: 2rem;
                margin-bottom: 5rem;
                overflow: visible;
                display: flex;
                flex-direction: column;
            }

            /* Hero Section */
            .market-hero {
                padding: 1rem;
                margin-bottom: 1rem;
                overflow: hidden;
            }

            .price-indicator {
                font-size: 1.75rem;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }

            /* Layout Sections */
            .market-sidebar {
                position: static !important;
                margin-bottom: 2.5rem;
                width: 100%;
                z-index: 1;
                order: 1;
            }

            .market-main {
                margin-bottom: 1rem;
                width: 100%;
                position: relative;
                z-index: 0;
                order: 2;
                clear: both;
            }

            /* Cards */
            .section-card, .chart-container {
                padding: 1rem;
                margin-bottom: 0;
                overflow: hidden;
                position: relative;
                z-index: 0;
                border-radius: 0;
                border-bottom: none;
            }

            .section-card:last-child, .chart-container:last-child {
                border-bottom: 1px solid rgba(0, 203, 151, 0.1);
                border-radius: 0;
            }

            .section-card:first-child, .chart-container:first-child {
                border-radius: 0;
            }

            .current-odds-card {
                margin-top: 0;
                border-top: 1px solid rgba(0, 203, 151, 0.1);
                padding-top: 1rem;
                z-index: 1;
                clear: both;
            }

            .chart-container {
                z-index: 2;
                margin-bottom: 0;
                border-bottom: 1px solid rgba(0, 203, 151, 0.1);
                border-radius: 0;
            }

            .current-odds-card {
                border-radius: 0;
            }

            .sidebar-card {
                padding: 1rem;
                margin-bottom: 0;
                overflow: visible;
                position: relative;
                z-index: 0;
                border-radius: 0;
                border-bottom: none;
            }

            .sidebar-card:last-child {
                border-bottom: 1px solid rgba(0, 203, 151, 0.12);
                border-radius: 0 0 0.75rem 0.75rem;
            }

            .sidebar-card:first-child {
                border-radius: 0.75rem 0.75rem 0 0;
            }

            /* Betting Interface */
            .bet-tab {
                padding: 0.875rem 1rem;
                font-size: 0.9375rem;
                min-height: 48px;
            }

            .bet-tab i {
                font-size: 1.125rem;
            }

            .quick-bet-btn {
                padding: 0.75rem 0.5rem !important;
                font-size: 0.875rem !important;
                min-height: 44px;
            }

            #bet-amount {
                padding: 0.875rem 1rem !important;
                font-size: 1rem !important;
                min-height: 52px;
            }

            #bet-summary {
                padding: 0.875rem !important;
                font-size: 0.875rem;
            }

            #place-bet-btn {
                padding: 1rem !important;
                font-size: 1rem !important;
                min-height: 52px;
            }

            /* Prevent Horizontal Overflow */
            img, svg {
                max-width: 100%;
                height: auto;
            }

            /* Stat Badges */
            .stat-badge {
                font-size: 0.7rem;
                padding: 0.35rem 0.65rem;
            }

            /* Timeframe Selector */
            .timeframe-selector {
                gap: 0.15rem;
                padding: 0.2rem;
                overflow-x: auto;
                overflow-y: hidden;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
            }

            .timeframe-selector::-webkit-scrollbar {
                display: none;
            }

            .timeframe-btn {
                padding: 0.5rem 0.6rem;
                font-size: 0.7rem;
                min-width: auto;
            }

            /* Price Chart - Fill Container */
            .chart-container {
                position: relative;
                width: 100%;
                max-width: 100%;
                height: auto;
                overflow: hidden;
                padding: 0 0 1.5rem 0;
            }

            .chart-container canvas {
                max-width: 100% !important;
                width: 100% !important;
                height: 100% !important;
                display: block;
            }

            #priceChart {
                max-width: 100% !important;
                width: 100% !important;
                height: 300px !important;
                overflow: hidden !important;
            }

            /* Ensure chart axes are visible */
            .chart-container > div {
                overflow: hidden !important;
            }

            .chart-container table {
                width: 100% !important;
            }

            .chart-container,
            .chart-container * {
                overflow: hidden !important;
                scrollbar-width: none;
            }

            .chart-container::-webkit-scrollbar,
            .chart-container *::-webkit-scrollbar {
                width: 0;
                height: 0;
            }
        }
    </style>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2580594240598942"
         crossorigin="anonymous"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen">

    <!-- Header Component -->
    <div id="header-container"
         data-page="market"
         data-show-view-mode="false"
         data-logo-link="true"
         data-show-admin="true">
    </div>

    <!-- Main Content -->
    <main class="w-full max-w-[1920px] mx-auto px-2 pb-20 main-content-padding">
        <div class="market-container">

            <!-- Breadcrumb Navigation -->
            <div class="flex items-center gap-1.5 pb-3 text-xs overflow-hidden"><a href="index.html" class="text-goat-teal no-underline shrink-0">←</a><span class="text-gray-500 shrink-0">Markets</span><span class="text-gray-600 shrink-0">/</span><span id="breadcrumb-category" class="text-gray-500 overflow-hidden text-ellipsis whitespace-nowrap max-w-[120px] shrink">Category</span><span class="text-gray-600 shrink-0">/</span><span id="breadcrumb-market-title" class="text-gray-400 overflow-hidden text-ellipsis whitespace-nowrap flex-1 min-w-0">Loading market...</span></div>

            <!-- Loading State -->
            <div id="loading-state" class="py-6">
                <div class="skeleton-container">
                    <div class="skeleton skeleton-heading w-2/3 mb-6"></div>
                    <div class="skeleton skeleton-chart mb-6"></div>
                    <div class="skeleton-stats">
                        <div class="skeleton-stat-card"></div>
                        <div class="skeleton-stat-card"></div>
                        <div class="skeleton-stat-card"></div>
                    </div>
                </div>
            </div>

            <!-- Error State -->
            <div id="error-state" class="hidden text-center py-20">
                <i class="ri-error-warning-line text-6xl text-red-500 mb-4"></i>
                <h2 class="text-2xl font-bold mb-2">Market Not Found</h2>
                <p class="text-gray-400 mb-6">The market you're looking for doesn't exist or has been removed.</p>
                <a href="index.html" class="inline-block px-6 py-3 bg-green-600 rounded-lg font-semibold hover:bg-green-700 transition">
                    Browse Markets
                </a>
            </div>

            <!-- Market Content (Hidden until loaded) -->
            <div id="market-content" class="hidden">

                <!-- Market Hero Section -->
                <div class="market-hero relative overflow-hidden">
                    <!-- Background Image -->
                    <div id="hero-bg-image" class="absolute inset-0 z-[1] opacity-0 transition-opacity duration-300"></div>

                    <!-- Dark green overlay -->
                    <div class="absolute inset-0 bg-gradient-to-br from-[rgba(0,180,90,0.35)] to-[rgba(0,120,60,0.65)] z-[2]"></div>
                    <!-- Green tint -->
                    <div class="absolute inset-0 market-hero-tint z-[2]"></div>

                    <!-- Content (relative to appear above background) -->
                    <div class="relative z-[3] market-hero-content">
                        <div class="flex items-center gap-2 mb-2">
                            <span id="category-badge" class="text-xs px-2.5 py-1 rounded-md font-semibold bg-[rgba(2,122,64,0.85)] text-white border border-[rgba(0,203,151,0.4)] backdrop-blur-[10px]">
                                Category
                            </span>
                            <span id="market-status" class="text-xs px-2.5 py-1 rounded-md font-semibold bg-[rgba(34,197,94,0.8)] text-white border border-[rgba(74,222,128,0.4)] backdrop-blur-[10px]">
                                Active
                            </span>
                        </div>
                        <h1 id="market-title" class="text-2xl md:text-3xl font-extrabold mb-2 leading-tight text-white [text-shadow:0_2px_12px_rgba(0,0,0,0.8),0_0_20px_rgba(0,0,0,0.6)]">
                            Loading...
                        </h1>
                        <div id="market-description" class="text-sm leading-relaxed mb-3 text-gray-200 [text-shadow:0_1px_8px_rgba(0,0,0,0.8)]">
                            Loading description...
                        </div>
                        <button id="market-description-toggle" class="hidden" type="button">
                            <span class="toggle-text">Show more</span>
                            <span class="chevron">▾</span>
                        </button>

                        <!-- Market Stats Row -->
                        <div class="flex flex-wrap gap-2 market-hero-stats">
                            <div class="stat-badge bg-black/75 backdrop-blur-[10px] border border-goat-teal/25">
                                <i class="ri-line-chart-line text-goat-teal"></i>
                                <span class="text-gray-300">Volume:</span>
                                <span class="font-semibold text-white" id="stat-volume">J$0</span>
                            </div>
                            <div class="stat-badge bg-black/75 backdrop-blur-[10px] border border-goat-teal/25">
                                <i class="ri-group-line text-goat-teal"></i>
                                <span class="text-gray-300">Traders:</span>
                                <span class="font-semibold text-white" id="stat-traders">0</span>
                            </div>
                            <div class="stat-badge bg-black/75 backdrop-blur-[10px] border border-goat-teal/25">
                                <i class="ri-time-line text-goat-teal"></i>
                                <span class="text-gray-300">Ends:</span>
                                <span class="font-semibold text-white" id="stat-time">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Grid Layout -->
                <div class="market-grid">

                    <!-- Main Column -->
                    <div class="market-main">

                        <!-- Price Chart -->
                        <div class="chart-container">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold">Price Chart</h3>
                                <div class="timeframe-selector">
                                    <button class="timeframe-btn active" data-timeframe="24h">24H</button>
                                    <button class="timeframe-btn" data-timeframe="7d">7D</button>
                                    <button class="timeframe-btn" data-timeframe="30d">30D</button>
                                    <button class="timeframe-btn" data-timeframe="all">ALL</button>
                                </div>
                            </div>
                            <div class="relative">
                                <!-- Y-axis label -->
                                <div class="absolute left-[-30px] top-1/2 -translate-y-1/2 chart-price-label text-[11px] font-semibold text-gray-400 whitespace-nowrap">
                                    PRICE (¢)
                                </div>
                                <!-- Chart container -->
                                <div id="priceChart" class="relative h-[400px] w-full"></div>
                                <!-- X-axis label -->
                                <div class="text-center mt-2 text-[11px] font-semibold text-gray-400">
                                    TIME
                                </div>
                            </div>
                        </div>

                        <!-- Current Odds -->
                        <div class="section-card mt-4 current-odds-card">
                            <h3 class="text-xl font-bold mb-4">Current Odds</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <!-- YES Odds -->
                                <div class="text-center p-6 rounded-xl odds-card odds-card-yes">
                                    <div class="text-sm font-semibold text-green-400 mb-2">YES</div>
                                    <div class="price-indicator text-green-400" id="yes-price">--¢</div>
                                    <div class="text-sm text-gray-400 mt-2" id="yes-profit">--% profit</div>
                                </div>
                                <!-- NO Odds -->
                                <div class="text-center p-6 rounded-xl odds-card odds-card-no">
                                    <div class="text-sm font-semibold text-red-400 mb-2">NO</div>
                                    <div class="price-indicator text-red-500" id="no-price">--¢</div>
                                    <div class="text-sm text-gray-400 mt-2" id="no-profit">--% profit</div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="section-card">
                            <button class="accordion-header w-full flex items-center justify-between bg-transparent border-none p-0 mb-4 cursor-pointer" id="activityAccordionBtn">
                                <h3 class="text-xl font-bold m-0 text-white">Recent Activity</h3>
                                <i class="ri-arrow-down-s-line accordion-chevron text-2xl text-gray-400 transition-transform duration-300" id="activity-chevron"></i>
                            </button>
                            <div id="activity-feed" class="accordion-content max-h-[600px] overflow-y-auto overflow-x-hidden transition-[max-height] duration-300">
                                <div class="text-center py-8 text-gray-400">
                                    <i class="ri-history-line text-4xl mb-2"></i>
                                    <p>No recent activity</p>
                                </div>
                            </div>
                        </div>

                        <!-- About This Market -->
                        <div class="section-card">
                            <h3 class="text-xl font-bold mb-4">About This Market</h3>

                            <!-- Market Description -->
                            <div class="mb-5">
                                <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wide mb-2">Description</h4>
                                <div class="text-gray-300 leading-relaxed" id="about-description">
                                    This market will resolve based on official announcements and verified sources.
                                </div>
                            </div>

                            <!-- Resolution Criteria -->
                            <div class="mb-5">
                                <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wide mb-3">Resolution Criteria</h4>
                                <div class="bg-gray-800/50 rounded-lg p-4 border border-gray-700">
                                    <p class="text-gray-300 text-sm leading-relaxed mb-3" id="resolution-criteria">
                                        This market will resolve based on official announcements and verified sources.
                                    </p>
                                    <div class="flex items-start gap-2 text-xs text-gray-400">
                                        <i class="ri-information-line mt-0.5"></i>
                                        <span>Resolution source will be clearly documented and publicly verifiable.</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Market Details -->
                            <div class="mb-5">
                                <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wide mb-3">Market Details</h4>
                                <div class="space-y-2.5">
                                    <div class="flex justify-between items-center py-2 border-b border-gray-800">
                                        <span class="text-sm text-gray-400">Market ID</span>
                                        <div class="flex items-center gap-2">
                                            <span class="font-mono text-sm text-gray-300" id="market-id">-</span>
                                            <button id="copy-market-id" class="copy-btn" title="Copy to clipboard">
                                                <i class="ri-file-copy-line"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-800">
                                        <span class="text-sm text-gray-400">Created</span>
                                        <span class="text-sm text-gray-300" id="market-created">-</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-800">
                                        <span class="text-sm text-gray-400">Closes</span>
                                        <span class="text-sm text-gray-300" id="market-closes">-</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-800">
                                        <span class="text-sm text-gray-400">Resolution Date</span>
                                        <span class="text-sm font-semibold text-white" id="resolution-date">-</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2">
                                        <span class="text-sm text-gray-400">Creator</span>
                                        <span class="text-sm text-gray-300" id="market-creator">GoatMouth</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Trading Rules -->
                            <div>
                                <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wide mb-3">Trading Rules</h4>
                                <div class="space-y-2">
                                    <div class="flex items-start gap-2 text-xs text-gray-400">
                                        <i class="ri-checkbox-circle-line text-gray-500 mt-0.5"></i>
                                        <span>Minimum bet: J$1.00</span>
                                    </div>
                                    <div class="flex items-start gap-2 text-xs text-gray-400">
                                        <i class="ri-checkbox-circle-line text-gray-500 mt-0.5"></i>
                                        <span>Trading fees: 2% on winning positions</span>
                                    </div>
                                    <div class="flex items-start gap-2 text-xs text-gray-400">
                                        <i class="ri-checkbox-circle-line text-gray-500 mt-0.5"></i>
                                        <span>Market can close early if resolution is certain</span>
                                    </div>
                                    <div class="flex items-start gap-2 text-xs text-gray-400">
                                        <i class="ri-checkbox-circle-line text-gray-500 mt-0.5"></i>
                                        <span>Payouts distributed within 24 hours of resolution</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Comments Section -->
                        <div class="section-card">
                            <!-- Section Header -->
                            <div class="flex items-center gap-2 mb-4">
                                <div class="w-1 h-6 rounded-full bg-gradient-to-b from-goat-teal to-[#027A40]"></div>
                                <h3 class="font-bold text-lg text-goat-teal">
                                    <i class="fa-solid fa-comments mr-2"></i>Discussion
                                </h3>
                            </div>

                            <!-- Comment Form (if logged in) -->
                            <div id="comment-form-container"></div>

                            <!-- Comments List -->
                            <div id="comments-list">
                                <div class="text-center py-8 text-gray-400">
                                    <i class="ri-chat-3-line text-4xl mb-2"></i>
                                    <p>Loading comments...</p>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Sidebar Column -->
                    <div class="market-sidebar">

                        <!-- Your Position (if user has position) -->
                        <div id="position-card" class="sidebar-card hidden">
                            <h3 class="text-lg font-bold mb-3">Your Position</h3>
                            <div class="position-card">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm text-gray-400">Shares</span>
                                    <span class="font-bold" id="position-shares">0</span>
                                </div>
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm text-gray-400">Avg. Cost</span>
                                    <span class="font-bold" id="position-avg-cost">-</span>
                                </div>
                                <div class="flex justify-between items-center pt-2 border-t border-green-700">
                                    <span class="text-sm font-semibold">P&L</span>
                                    <span class="font-bold text-green-400" id="position-pnl">+J$0.00</span>
                                </div>
                            </div>
                        </div>

                        <!-- Betting Interface -->
                        <div class="sidebar-card">
                            <h3 class="text-lg font-bold mb-3">Place Bet</h3>

                            <!-- Bet Tabs -->
                            <div class="flex border-b border-gray-700 mb-4">
                                <button class="bet-tab active" data-outcome="yes">
                                    <i class="ri-check-line"></i> Buy YES
                                </button>
                                <button class="bet-tab" data-outcome="no">
                                    <i class="ri-close-line"></i> Buy NO
                                </button>
                            </div>

                            <div id="bet-interface">
                                <!-- Logged out state -->
                                <div id="bet-login-prompt" class="text-center py-6">
                                    <i class="ri-lock-line text-4xl text-gray-500 mb-3"></i>
                                    <p class="text-gray-400 mb-4">Sign in to place bets</p>
                                    <button id="betSignInBtn" class="w-full px-4 py-3 bg-green-600 rounded-lg font-semibold hover:bg-green-700 transition">
                                        Sign In
                                    </button>
                                </div>

                                <!-- Logged in betting form -->
                                <div id="bet-form" class="hidden outcome-yes">
                                    <!-- Amount input - Primary Focus -->
                                    <input
                                        type="number"
                                        id="bet-amount"
                                        placeholder="Enter bet amount (J$)"
                                        class="w-full px-5 py-4 bg-gray-800 border border-gray-600 rounded-lg mb-4 focus:outline-none focus:border-gray-500 text-xl font-semibold text-center"
                                        min="1"
                                        step="0.01"
                                        autofocus
                                    >

                                    <!-- Quick amounts -->
                                    <div class="grid grid-cols-4 gap-2 mb-3">
                                        <button class="quick-bet-btn px-3 py-2 rounded-lg border border-gray-600 hover:border-green-500 transition text-sm font-semibold" data-amount="500">
                                            J$500
                                        </button>
                                        <button class="quick-bet-btn px-3 py-2 rounded-lg border border-gray-600 hover:border-green-500 transition text-sm font-semibold" data-amount="1000">
                                            J$1K
                                        </button>
                                        <button class="quick-bet-btn px-3 py-2 rounded-lg border border-gray-600 hover:border-green-500 transition text-sm font-semibold" data-amount="5000">
                                            J$5K
                                        </button>
                                        <button class="quick-bet-btn px-3 py-2 rounded-lg border border-gray-600 hover:border-green-500 transition text-sm font-semibold" data-amount="10000">
                                            J$10K
                                        </button>
                                    </div>

                                    <!-- Bet summary -->
                                    <div id="bet-summary" class="hidden mb-4 p-4 rounded-lg bet-summary-yes">
                                        <div class="flex items-start justify-between gap-4">
                                            <div>
                                                <div class="text-xs uppercase tracking-wide text-gray-400">Estimated profit</div>
                                                <div class="text-2xl font-bold leading-tight" id="summary-profit">-</div>
                                            </div>
                                            <div class="text-right text-xs text-gray-400">
                                                <div>Total payout</div>
                                                <div class="text-sm font-semibold text-gray-200" id="summary-shares">-</div>
                                                <div class="mt-2">Odds</div>
                                                <div class="text-sm font-semibold text-gray-200" id="summary-price">-</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Place bet button -->
                                    <button
                                        id="place-bet-btn"
                                        disabled
                                        class="w-full px-4 py-3 place-bet-yes rounded-lg font-bold transition disabled:opacity-50 disabled:cursor-not-allowed"
                                    >
                                        Place Bet
                                    </button>

                                    <!-- Balance -->
                                    <div class="text-center text-sm text-gray-400 mt-3">
                                        Balance: <span class="font-semibold text-white" id="user-balance">J$0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Market Info -->
                        <div class="sidebar-card">
                            <h3 class="text-lg font-bold mb-3">Market Info</h3>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Category</span>
                                    <span class="font-semibold" id="info-category">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Total Volume</span>
                                    <span class="font-semibold" id="info-volume">J$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">24h Volume</span>
                                    <span class="font-semibold" id="info-24h-volume">J$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Liquidity</span>
                                    <span class="font-semibold" id="info-liquidity">J$0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Share Market -->
                        <div class="sidebar-card">
                            <h3 class="text-lg font-bold mb-3">Share</h3>
                            <div class="grid grid-cols-3 gap-2">
                                <button class="p-3 rounded-lg bg-gray-700 hover:bg-gray-600 transition text-center" title="Copy Link">
                                    <i class="ri-link text-xl text-green-400"></i>
                                    <div class="text-xs mt-1">Copy</div>
                                </button>
                                <button class="p-3 rounded-lg bg-gray-700 hover:bg-gray-600 transition text-center" title="Twitter">
                                    <i class="ri-twitter-x-line text-xl text-[#1DA1F2]"></i>
                                    <div class="text-xs mt-1">Twitter</div>
                                </button>
                                <button class="p-3 rounded-lg bg-gray-700 hover:bg-gray-600 transition text-center" title="WhatsApp">
                                    <i class="ri-whatsapp-line text-xl text-[#25D366]"></i>
                                    <div class="text-xs mt-1">WhatsApp</div>
                                </button>
                            </div>
                        </div>

                    </div>

                </div>

            </div>

        </div>
    </main>

    <!-- Footer Component -->
    <div id="footer-container"></div>

    <!-- Mobile Bottom Nav -->
    <div id="mobile-nav-container" data-page="markets"></div>

    <!-- Scripts -->
    <script defer src="js/supabase-client.js?v=4.6"></script>
    <script defer src="js/sanitize-helper.js?v=4.6"></script>
    <script type="module" src="js/utils-loader.js"></script>
    <script defer src="js/api.js?v=4.6"></script>
    <script defer src="js/toast.js?v=4.6"></script>
    <script defer src="js/shared-components.js"></script>
    <script defer src="js/header-component.js"></script>
    <script defer src="js/footer-component.js"></script>

    <!-- Market Page Script -->
    <script defer src="js/market-page.js?v=4.6"></script>

    <!-- Copy to Clipboard Functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize banner carousel
            if (window.supabaseClient && window.GoatMouthAPI && window.BannerCarousel) {
                const bannerContainer = document.getElementById('banner-container');
                if (bannerContainer) {
                    const api = new GoatMouthAPI(window.supabaseClient);
                    const mockApp = { api: api };
                    const bannerCarousel = new BannerCarousel(mockApp);
                    await bannerCarousel.loadBanners();

                    if (bannerCarousel.banners && bannerCarousel.banners.length > 0) {
                        bannerCarousel.render(bannerContainer);
                    }
                }
            }

            const copyBtn = document.getElementById('copy-market-id');

            if (copyBtn) {
                copyBtn.addEventListener('click', function() {
                    const marketId = document.getElementById('market-id').textContent;

                    // Copy to clipboard
                    navigator.clipboard.writeText(marketId).then(function() {
                        // Visual feedback
                        copyBtn.classList.add('copied');
                        const icon = copyBtn.querySelector('i');
                        const originalClass = icon.className;
                        icon.className = 'ri-check-line';

                        // Reset after 2 seconds
                        setTimeout(function() {
                            copyBtn.classList.remove('copied');
                            icon.className = originalClass;
                        }, 2000);
                    }).catch(function(err) {
                        console.error('Failed to copy:', err);
                    });
                });
            }

            // Activity accordion event listener
            const activityAccordionBtn = document.getElementById('activityAccordionBtn');
            if (activityAccordionBtn) {
                activityAccordionBtn.addEventListener('click', toggleActivityAccordion);
            }

            // Sign in button event listener
            const betSignInBtn = document.getElementById('betSignInBtn');
            if (betSignInBtn) {
                betSignInBtn.addEventListener('click', () => {
                    window.location.href = 'index.html#login';
                });
            }
        });

        // Activity Accordion Toggle
        function toggleActivityAccordion() {
            const activityFeed = document.getElementById('activity-feed');
            const chevron = document.getElementById('activity-chevron');

            if (activityFeed.style.maxHeight === '0px' || activityFeed.style.maxHeight === '') {
                activityFeed.style.maxHeight = '600px';
                chevron.style.transform = 'rotate(0deg)';
            } else {
                activityFeed.style.maxHeight = '0px';
                chevron.style.transform = 'rotate(-180deg)';
            }
        }
    </script>

</body>
</html>
